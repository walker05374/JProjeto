{% extends 'site/base.html' %}
{% load static %}

{% block title %}Acervo de Artigos para Gestantes{% endblock %}

{% block content %}
  <title>Acervo de Artigos para Gestantes</title>
  <link rel="stylesheet" href="{% static 'css/peso/livros_acervo.css' %}">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

  <div class="background py-5">
    <div class="container">
      <!-- ALERTA DE MENSAGEM -->
      {% if messages %}
        <div class="alert alert-success alert-dismissible fade show mt-4 mx-auto" role="alert" style="max-width: 1100px; border-radius: 12px; font-weight: 500;">
          {% for message in messages %}
            {{ message }}
          {% endfor %}
          <button type="button" class="close" data-dismiss="alert" aria-label="Fechar">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
      {% endif %}

      <!-- TÍTULO DO ACERVO E CAMPO DE PESQUISA -->
      <div class="row justify-content-center align-items-start g-5">
        <div class="col-md-12 text-center">
          <h2 class="text-primary mb-4">
            <i class="fas fa-book"></i> Acervo de Artigos para Gestantes
          </h2>
        </div>

        <!-- Campo de Pesquisa -->
        <div class="col-md-12 text-center mb-4">
          <form method="get" action="{% url 'buscar_livros' %}">
            <input type="text" name="query" class="form-control" placeholder="Buscar por título, autor ou tema" value="{{ query }}">
            <button type="submit" class="btn btn-primary mt-2">
              <i class="fas fa-search"></i> Buscar
            </button>
          </form>
        </div>

        <!-- Exibição de Artigos -->
        {% if page_obj.object_list %}
          <div class="col-md-12">
            <div class="row justify-content-center">
              {% for artigo in page_obj.object_list %}
                <div class="col-md-3 col-sm-6 mb-4">
                  <div class="card shadow rounded-4">
                    <div class="card-body">
                      <h5 class="card-title text-center text-primary">{{ artigo.title }}</h5>
                      <p class="text-center">Autor: {{ artigo.author_name|join:", " }}</p>
                      <p class="card-text text-center">
                        <strong>Publicado em:</strong> {{ artigo.first_publish_year }}
                      </p>

<!-- Exibir Capa do Artigo ou Texto "Sem Capa Disponível" -->
{% if artigo.cover_i %}
  <img src="{{ artigo.cover_i }}" class="card-img-top" alt="Capa do Artigo">
{% else %}
  <div class="no-cover-img">Sem Capa Disponível</div>
{% endif %}


                      <div class="text-center">
                        <a href="https://books.google.com.br/books?id={{ artigo.url }}" target="_blank" class="btn btn-outline-primary btn-lg">
                          <i class="fas fa-book-open"></i> Ler Livro
                        </a>
                      </div>
                    </div>
                  </div>
                </div>
              {% endfor %}
            </div>
          </div>
        {% else %}
          <div class="col-md-12 text-center">
            <p>Não há artigos disponíveis para o tema "{{ query }}". Tente novamente mais tarde ou busque por outro tema.</p>
          </div>
        {% endif %}
      </div>
<!-- Paginação - Numerada e "Próxima" -->
<div class="pagination justify-content-center">
  {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}" class="page-link">
      <i class="fas fa-angle-left"></i>  <!-- Botão "Anterior" -->
    </a>
  {% endif %}

  {% for num in page_obj.paginator.page_range %}
    <a href="?page={{ num }}" class="page-link {% if page_obj.number == num %} active {% endif %}">
      {{ num }}  <!-- Botões numerados -->
    </a>
  {% endfor %}

  {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}" class="page-link">
      <i class="fas fa-angle-right"></i>  <!-- Botão "Próxima" -->
    </a>
  {% endif %}


      </div>
    </div>
  </div>
{% endblock %}
